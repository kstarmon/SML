__文件夹结构__

- SML 
  
  - dataset 数据集
    
    - test 测试集
    
    - w1 语义类1
    
    - w2 语义类2
    
    - w3 语义类3
    
    - w4 语义类4
  
  - model 模型保存
    
    - 1.pickle 语义类1的模型
    
    - 2.pickle 语义类2的模型
    
    - 3.pickle 语义类3的模型
    
    - 4.pickle 语义类4的模型
  
  - sml.py 实现代码

__图片说明__

此处图片来源为 “北邮学长” 收集的四个语义类：森林、建筑、天空和道路。每个图片均为300*450的大小（以像素计），图片命令格式为 数字+.jpg

__SML代码说明__

- 调用库
  
  - time    计算时间，可以不用。不用的话删掉所以time函数
  
  - cv2   加载图片，图片通道变换和dct变换，需要
  
  - pickle   保存模型用，已经保存了，可以不用
  
  - sklearn   调用 GMM 模型，需要
  
  - numpy    一些数据处理，需要

- 实现思路：
  
  - 训练部分，主要是要搭建基于一个语义类的类模型。先对每个图片进行特征抽取，特征抽取基于GMM，之后基于同一个语义类图像的特征，再次进行GMM。对于一个语义类，即一个图片文件夹里的图片：
    
    - 图片预处理部分：加载图片-->转为YCrCb格式-->图像分块-->dct变化
    
    - 特征提取：基于dct变化的图片块构建特征数据集-->GMM-->得到图像特征的GMM参数
    
    - 类模型：基于图像特征的GMM参数构建语义类的数据集-->GMM-->类模型
  
  - 标注部分，对于待标注的图片，进行特征抽取后，计算相对于每个类模型极大似然，选最大值进行标注。
    
    - 存在的问题
      
      - 这里和PPT略有不同：首先不可知每个语义类的概率，其次没有减去特征概率
      
      - 只选了最大值进行标注，但是其实这个是对语义类的建模，一个图片里面可能不只含有一个语义类，只是比重多少

- 函数及其功能
  
  - `sml()` 主函数：整个过程实现，以及类模型构造和标注
  
  - `load_picture` 加载一个语义类的所有图片并转为YCrCb格式
  
  - `split_and_2dct` 分割图片并转换为dct, 将每一个小块的数据展为一维
  
  - `feature_GMM` 进行图像特征提取, 基于 6 组高斯分量
  
  - `zigzag` zigzag 扫描
  
  其他详见sml.py
